{"expireTime":9007200901521021000,"key":"transformer-remark-markdown-ast-e991b6bead2cd8ee034c6a08f6e9a390-gatsby-remark-autolink-headersgatsby-remark-copy-linked-filesgatsby-remark-mermaidgatsby-remark-code-titlesgatsby-remark-prismjsgatsby-remark-rewrite-relative-linksgatsby-remark-check-links-","val":{"type":"root","children":[{"type":"paragraph","children":[{"type":"text","value":"Certain features of the Apollo platform require Apollo Server to make outgoing requests to Apollo Studio.  These include:","position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":122,"offset":122}}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":122,"offset":122}}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Managed federation","position":{"start":{"line":4,"column":3,"offset":126},"end":{"line":4,"column":21,"offset":144}}}],"position":{"start":{"line":4,"column":3,"offset":126},"end":{"line":4,"column":21,"offset":144}}}],"position":{"start":{"line":4,"column":1,"offset":124},"end":{"line":4,"column":21,"offset":144}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Operation registry","position":{"start":{"line":5,"column":3,"offset":147},"end":{"line":5,"column":21,"offset":165}}}],"position":{"start":{"line":5,"column":3,"offset":147},"end":{"line":5,"column":21,"offset":165}}}],"position":{"start":{"line":5,"column":1,"offset":145},"end":{"line":5,"column":21,"offset":165}}}],"position":{"start":{"line":4,"column":1,"offset":124},"end":{"line":5,"column":21,"offset":165}}},{"type":"paragraph","children":[{"type":"text","value":"Depending on security policies, you might need to configure an outgoing HTTP proxy in order to allow these requests.","position":{"start":{"line":7,"column":1,"offset":167},"end":{"line":7,"column":117,"offset":283}}}],"position":{"start":{"line":7,"column":1,"offset":167},"end":{"line":7,"column":117,"offset":283}}},{"type":"paragraph","children":[{"type":"text","value":"While Apollo Server supports standard Node.js \"agent\" configuration via ","position":{"start":{"line":9,"column":1,"offset":285},"end":{"line":9,"column":73,"offset":357}}},{"type":"link","title":null,"url":"https://nodejs.org/api/https.html#https_https_globalagent","children":[{"type":"html","value":"<code class=\"language-text\">https.globalAgent</code>","position":{"start":{"line":9,"column":74,"offset":358},"end":{"line":9,"column":93,"offset":377}}}],"position":{"start":{"line":9,"column":73,"offset":357},"end":{"line":9,"column":153,"offset":437}}},{"type":"text","value":" and ","position":{"start":{"line":9,"column":153,"offset":437},"end":{"line":9,"column":158,"offset":442}}},{"type":"link","title":null,"url":"https://nodejs.org/api/http.html#http_http_globalagent","children":[{"type":"html","value":"<code class=\"language-text\">http.globalAgent</code>","position":{"start":{"line":9,"column":159,"offset":443},"end":{"line":9,"column":177,"offset":461}}}],"position":{"start":{"line":9,"column":158,"offset":442},"end":{"line":9,"column":234,"offset":518}}},{"type":"text","value":" directly, we recommend using the ","position":{"start":{"line":9,"column":234,"offset":518},"end":{"line":9,"column":268,"offset":552}}},{"type":"link","title":null,"url":"https://github.com/gajus/global-agent#global-agent","children":[{"type":"html","value":"<code class=\"language-text\">global-agent</code>","position":{"start":{"line":9,"column":269,"offset":553},"end":{"line":9,"column":283,"offset":567}}}],"position":{"start":{"line":9,"column":268,"offset":552},"end":{"line":9,"column":336,"offset":620}}},{"type":"text","value":" package to reduce the amount of necessary configuration involved with ","position":{"start":{"line":9,"column":336,"offset":620},"end":{"line":9,"column":407,"offset":691}}},{"type":"link","title":null,"url":"https://nodejs.org/api/http.html#http_class_http_agent","children":[{"type":"text","value":"creating a custom agent","position":{"start":{"line":9,"column":408,"offset":692},"end":{"line":9,"column":431,"offset":715}}}],"position":{"start":{"line":9,"column":407,"offset":691},"end":{"line":9,"column":488,"offset":772}}},{"type":"text","value":".","position":{"start":{"line":9,"column":488,"offset":772},"end":{"line":9,"column":489,"offset":773}}}],"position":{"start":{"line":9,"column":1,"offset":285},"end":{"line":9,"column":489,"offset":773}}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":11,"column":1,"offset":775},"end":{"line":11,"column":5,"offset":779}}},{"type":"html","value":"<code class=\"language-text\">global-agent</code>","position":{"start":{"line":11,"column":5,"offset":779},"end":{"line":11,"column":19,"offset":793}}},{"type":"text","value":" package allows support for the common technique of setting proxy settings using environment variables (e.g. ","position":{"start":{"line":11,"column":19,"offset":793},"end":{"line":11,"column":128,"offset":902}}},{"type":"html","value":"<code class=\"language-text\">HTTP_PROXY</code>","position":{"start":{"line":11,"column":128,"offset":902},"end":{"line":11,"column":140,"offset":914}}},{"type":"text","value":", ","position":{"start":{"line":11,"column":140,"offset":914},"end":{"line":11,"column":142,"offset":916}}},{"type":"html","value":"<code class=\"language-text\">NO_AGENT</code>","position":{"start":{"line":11,"column":142,"offset":916},"end":{"line":11,"column":152,"offset":926}}},{"type":"text","value":", etc.), which is not supported by Node.js itself (and ","position":{"start":{"line":11,"column":152,"offset":926},"end":{"line":11,"column":207,"offset":981}}},{"type":"link","title":null,"url":"https://github.com/nodejs/node/issues/15620","children":[{"type":"text","value":"may never be","position":{"start":{"line":11,"column":208,"offset":982},"end":{"line":11,"column":220,"offset":994}}}],"position":{"start":{"line":11,"column":207,"offset":981},"end":{"line":11,"column":266,"offset":1040}}},{"type":"text","value":").","position":{"start":{"line":11,"column":266,"offset":1040},"end":{"line":11,"column":268,"offset":1042}}}],"position":{"start":{"line":11,"column":1,"offset":775},"end":{"line":11,"column":268,"offset":1042}}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#configuring-the-proxy-agent","title":null,"children":[],"data":{"hProperties":{"aria-label":"configuring the proxy agent permalink","class":"anchor before"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"Configuring the proxy agent","position":{"start":{"line":13,"column":4,"offset":1047},"end":{"line":13,"column":31,"offset":1074}}}],"position":{"start":{"line":13,"column":1,"offset":1044},"end":{"line":13,"column":31,"offset":1074}},"data":{"id":"configuring-the-proxy-agent","htmlAttributes":{"id":"configuring-the-proxy-agent"},"hProperties":{"id":"configuring-the-proxy-agent","style":"position:relative;"}}},{"type":"paragraph","children":[{"type":"text","value":"This guide covers the ","position":{"start":{"line":15,"column":1,"offset":1076},"end":{"line":15,"column":23,"offset":1098}}},{"type":"html","value":"<code class=\"language-text\">global-agent</code>","position":{"start":{"line":15,"column":23,"offset":1098},"end":{"line":15,"column":37,"offset":1112}}},{"type":"text","value":" package which is supported by Node.js versions v10 and higher.  When using Node.js versions ","position":{"start":{"line":15,"column":37,"offset":1112},"end":{"line":15,"column":130,"offset":1205}}},{"type":"emphasis","children":[{"type":"text","value":"prior","position":{"start":{"line":15,"column":131,"offset":1206},"end":{"line":15,"column":136,"offset":1211}}}],"position":{"start":{"line":15,"column":130,"offset":1205},"end":{"line":15,"column":137,"offset":1212}}},{"type":"text","value":" to v10, consider using the ","position":{"start":{"line":15,"column":137,"offset":1212},"end":{"line":15,"column":165,"offset":1240}}},{"type":"link","title":null,"url":"https://github.com/np-maintain/global-tunnel","children":[{"type":"html","value":"<code class=\"language-text\">global-tunnel-ng</code>","position":{"start":{"line":15,"column":166,"offset":1241},"end":{"line":15,"column":184,"offset":1259}}}],"position":{"start":{"line":15,"column":165,"offset":1240},"end":{"line":15,"column":231,"offset":1306}}},{"type":"text","value":" which behaves similarly, but is configured differently.","position":{"start":{"line":15,"column":231,"offset":1306},"end":{"line":15,"column":287,"offset":1362}}}],"position":{"start":{"line":15,"column":1,"offset":1076},"end":{"line":15,"column":287,"offset":1362}}},{"type":"heading","depth":3,"children":[{"type":"link","url":"#installing-the-global-agent-dependency","title":null,"children":[],"data":{"hProperties":{"aria-label":"installing the global agent dependency permalink","class":"anchor before"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"Installing the ","position":{"start":{"line":17,"column":5,"offset":1368},"end":{"line":17,"column":20,"offset":1383}}},{"type":"html","value":"<code class=\"language-text\">global-agent</code>","position":{"start":{"line":17,"column":20,"offset":1383},"end":{"line":17,"column":34,"offset":1397}}},{"type":"text","value":" dependency","position":{"start":{"line":17,"column":34,"offset":1397},"end":{"line":17,"column":45,"offset":1408}}}],"position":{"start":{"line":17,"column":1,"offset":1364},"end":{"line":17,"column":45,"offset":1408}},"data":{"id":"installing-the-global-agent-dependency","htmlAttributes":{"id":"installing-the-global-agent-dependency"},"hProperties":{"id":"installing-the-global-agent-dependency","style":"position:relative;"}}},{"type":"paragraph","children":[{"type":"text","value":"First, install the ","position":{"start":{"line":19,"column":1,"offset":1410},"end":{"line":19,"column":20,"offset":1429}}},{"type":"html","value":"<code class=\"language-text\">global-agent</code>","position":{"start":{"line":19,"column":20,"offset":1429},"end":{"line":19,"column":34,"offset":1443}}},{"type":"text","value":" package with your dependency manager:","position":{"start":{"line":19,"column":34,"offset":1443},"end":{"line":19,"column":72,"offset":1481}}}],"position":{"start":{"line":19,"column":1,"offset":1410},"end":{"line":19,"column":72,"offset":1481}}},{"type":"html","lang":null,"meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">npm install global-agent</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>","position":{"start":{"line":21,"column":1,"offset":1483},"end":{"line":23,"column":4,"offset":1515}}},{"type":"heading","depth":3,"children":[{"type":"link","url":"#bootstrapping-the-global-agent-proxy-agent","title":null,"children":[],"data":{"hProperties":{"aria-label":"bootstrapping the global agent proxy agent permalink","class":"anchor before"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"Bootstrapping the ","position":{"start":{"line":25,"column":5,"offset":1521},"end":{"line":25,"column":23,"offset":1539}}},{"type":"html","value":"<code class=\"language-text\">global-agent</code>","position":{"start":{"line":25,"column":23,"offset":1539},"end":{"line":25,"column":37,"offset":1553}}},{"type":"text","value":" proxy agent","position":{"start":{"line":25,"column":37,"offset":1553},"end":{"line":25,"column":49,"offset":1565}}}],"position":{"start":{"line":25,"column":1,"offset":1517},"end":{"line":25,"column":49,"offset":1565}},"data":{"id":"bootstrapping-the-global-agent-proxy-agent","htmlAttributes":{"id":"bootstrapping-the-global-agent-proxy-agent"},"hProperties":{"id":"bootstrapping-the-global-agent-proxy-agent","style":"position:relative;"}}},{"type":"paragraph","children":[{"type":"text","value":"After the ","position":{"start":{"line":27,"column":1,"offset":1567},"end":{"line":27,"column":11,"offset":1577}}},{"type":"html","value":"<code class=\"language-text\">global-agent</code>","position":{"start":{"line":27,"column":11,"offset":1577},"end":{"line":27,"column":25,"offset":1591}}},{"type":"text","value":" dependency has been installed, invoke its ","position":{"start":{"line":27,"column":25,"offset":1591},"end":{"line":27,"column":68,"offset":1634}}},{"type":"html","value":"<code class=\"language-text\">bootstrap</code>","position":{"start":{"line":27,"column":68,"offset":1634},"end":{"line":27,"column":79,"offset":1645}}},{"type":"text","value":" method ","position":{"start":{"line":27,"column":79,"offset":1645},"end":{"line":27,"column":87,"offset":1653}}},{"type":"strong","children":[{"type":"text","value":"before","position":{"start":{"line":27,"column":89,"offset":1655},"end":{"line":27,"column":95,"offset":1661}}}],"position":{"start":{"line":27,"column":87,"offset":1653},"end":{"line":27,"column":97,"offset":1663}}},{"type":"text","value":" Apollo Server is initialized:","position":{"start":{"line":27,"column":97,"offset":1663},"end":{"line":27,"column":127,"offset":1693}}}],"position":{"start":{"line":27,"column":1,"offset":1567},"end":{"line":27,"column":127,"offset":1693}}},{"type":"html","lang":"js{2-5})","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> ApolloServer<span class=\"token punctuation\">,</span> gql <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'apollo-server'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">bootstrap</span><span class=\"token operator\">:</span> bootstrapGlobalAgent <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'global-agent'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Setup global support for environment variable based proxy configuration.</span>\n<span class=\"token function\">bootstrapGlobalAgent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// The following represents existing configuration, though its</span>\n<span class=\"token comment\">// important to bootstrap the agent before Apollo Server.</span>\n<span class=\"token keyword\">const</span> server <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ApolloServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  typesDefs<span class=\"token punctuation\">,</span>\n  resolvers<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":29,"column":1,"offset":1695},"end":{"line":42,"column":4,"offset":2122}}},{"type":"heading","depth":3,"children":[{"type":"link","url":"#configuring-the-proxy-using-environment-variables","title":null,"children":[],"data":{"hProperties":{"aria-label":"configuring the proxy using environment variables permalink","class":"anchor before"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"Configuring the proxy using environment variables","position":{"start":{"line":44,"column":5,"offset":2128},"end":{"line":44,"column":54,"offset":2177}}}],"position":{"start":{"line":44,"column":1,"offset":2124},"end":{"line":44,"column":54,"offset":2177}},"data":{"id":"configuring-the-proxy-using-environment-variables","htmlAttributes":{"id":"configuring-the-proxy-using-environment-variables"},"hProperties":{"id":"configuring-the-proxy-using-environment-variables","style":"position:relative;"}}},{"type":"paragraph","children":[{"type":"text","value":"Depending on the deployment environment (e.g. AWS, Heroku, Kubernetes, Docker, etc.), environment variables may be set differently.  These instructions will demonstrate how to start a ","position":{"start":{"line":46,"column":1,"offset":2179},"end":{"line":46,"column":185,"offset":2363}}},{"type":"html","value":"<code class=\"language-text\">node</code>","position":{"start":{"line":46,"column":185,"offset":2363},"end":{"line":46,"column":191,"offset":2369}}},{"type":"text","value":" process using environment variables in a Unix-based shell.","position":{"start":{"line":46,"column":191,"offset":2369},"end":{"line":46,"column":250,"offset":2428}}}],"position":{"start":{"line":46,"column":1,"offset":2179},"end":{"line":46,"column":250,"offset":2428}}},{"type":"paragraph","children":[{"type":"text","value":"By default, the above bootstrapping step will enable the following environment variables:","position":{"start":{"line":48,"column":1,"offset":2430},"end":{"line":48,"column":90,"offset":2519}}}],"position":{"start":{"line":48,"column":1,"offset":2430},"end":{"line":48,"column":90,"offset":2519}}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">GLOBAL_AGENT_HTTP_PROXY</code>","position":{"start":{"line":50,"column":3,"offset":2523},"end":{"line":50,"column":28,"offset":2548}}}],"position":{"start":{"line":50,"column":3,"offset":2523},"end":{"line":50,"column":28,"offset":2548}}},{"type":"paragraph","children":[{"type":"text","value":"This is often the most important and solely necessary environment variable to set.","position":{"start":{"line":52,"column":3,"offset":2552},"end":{"line":52,"column":85,"offset":2634}}}],"position":{"start":{"line":52,"column":3,"offset":2552},"end":{"line":52,"column":85,"offset":2634}}}],"position":{"start":{"line":50,"column":1,"offset":2521},"end":{"line":52,"column":85,"offset":2634}}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">GLOBAL_AGENT_HTTPS_PROXY</code>","position":{"start":{"line":54,"column":3,"offset":2638},"end":{"line":54,"column":29,"offset":2664}}}],"position":{"start":{"line":54,"column":3,"offset":2638},"end":{"line":54,"column":29,"offset":2664}}},{"type":"paragraph","children":[{"type":"text","value":"This variable defines where HTTPS traffic (i.e. encrypted SSL/TLS traffic) is proxied.  If this is not set, HTTPS traffic will route through the HTTP proxy.","position":{"start":{"line":56,"column":3,"offset":2668},"end":{"line":56,"column":159,"offset":2824}}}],"position":{"start":{"line":56,"column":3,"offset":2668},"end":{"line":56,"column":159,"offset":2824}}}],"position":{"start":{"line":54,"column":1,"offset":2636},"end":{"line":56,"column":159,"offset":2824}}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">GLOBAL_AGENT_NO_PROXY</code>","position":{"start":{"line":58,"column":3,"offset":2828},"end":{"line":58,"column":26,"offset":2851}}}],"position":{"start":{"line":58,"column":3,"offset":2828},"end":{"line":58,"column":26,"offset":2851}}},{"type":"paragraph","children":[{"type":"text","value":"This variable allows the exclusion of certain domains from being proxied.","position":{"start":{"line":60,"column":3,"offset":2855},"end":{"line":60,"column":76,"offset":2928}}}],"position":{"start":{"line":60,"column":3,"offset":2855},"end":{"line":60,"column":76,"offset":2928}}}],"position":{"start":{"line":58,"column":1,"offset":2826},"end":{"line":60,"column":76,"offset":2928}}}],"position":{"start":{"line":50,"column":1,"offset":2521},"end":{"line":60,"column":76,"offset":2928}}},{"type":"paragraph","children":[{"type":"text","value":"By setting these environment variables, it is possible to configure ","position":{"start":{"line":62,"column":1,"offset":2930},"end":{"line":62,"column":69,"offset":2998}}},{"type":"html","value":"<code class=\"language-text\">global-agent</code>","position":{"start":{"line":62,"column":69,"offset":2998},"end":{"line":62,"column":83,"offset":3012}}},{"type":"text","value":"'s creation of the agent that is used for outgoing requests.  If the proxy requires special certificates for SSL/TLS requests, read the details later in this page.","position":{"start":{"line":62,"column":83,"offset":3012},"end":{"line":62,"column":246,"offset":3175}}}],"position":{"start":{"line":62,"column":1,"offset":2930},"end":{"line":62,"column":246,"offset":3175}}},{"type":"paragraph","children":[{"type":"text","value":"Using the appropriate environment variables, define them when starting the server.  For example, to send all outgoing requests from a Node.js server through ","position":{"start":{"line":64,"column":1,"offset":3177},"end":{"line":64,"column":158,"offset":3334}}},{"type":"html","value":"<code class=\"language-text\">http://proxy:3128</code>","position":{"start":{"line":64,"column":158,"offset":3334},"end":{"line":64,"column":177,"offset":3353}}},{"type":"text","value":", the configuration would be:","position":{"start":{"line":64,"column":177,"offset":3353},"end":{"line":64,"column":206,"offset":3382}}}],"position":{"start":{"line":64,"column":1,"offset":3177},"end":{"line":64,"column":206,"offset":3382}}},{"type":"html","lang":"shell","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">$ <span class=\"token assign-left variable\">GLOBAL_AGENT_HTTP_PROXY</span><span class=\"token operator\">=</span>http://proxy:3128/ <span class=\"token function\">node</span> index.js</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>","position":{"start":{"line":66,"column":1,"offset":3384},"end":{"line":68,"column":4,"offset":3455}}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":70,"column":1,"offset":3457},"end":{"line":70,"column":5,"offset":3461}}},{"type":"html","value":"<code class=\"language-text\">GLOBAL_AGENT_NO_PROXY</code>","position":{"start":{"line":70,"column":5,"offset":3461},"end":{"line":70,"column":28,"offset":3484}}},{"type":"text","value":" environment variable can also be defined to exclude certain URLs from being proxied:","position":{"start":{"line":70,"column":28,"offset":3484},"end":{"line":70,"column":113,"offset":3569}}}],"position":{"start":{"line":70,"column":1,"offset":3457},"end":{"line":70,"column":113,"offset":3569}}},{"type":"html","lang":"shell","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">$ <span class=\"token assign-left variable\">GLOBAL_AGENT_NO_PROXY</span><span class=\"token operator\">=</span><span class=\"token string\">'*.foo.com,10.0.1.100,baz.com'</span> <span class=\"token function\">node</span> index.js</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>","position":{"start":{"line":72,"column":1,"offset":3571},"end":{"line":74,"column":4,"offset":3652}}},{"type":"blockquote","children":[{"type":"paragraph","children":[{"type":"text","value":"For more information, see ","position":{"start":{"line":76,"column":3,"offset":3656},"end":{"line":76,"column":29,"offset":3682}}},{"type":"link","title":null,"url":"https://github.com/gajus/global-agent#exclude-urls","children":[{"type":"text","value":"Exclude URLs","position":{"start":{"line":76,"column":30,"offset":3683},"end":{"line":76,"column":42,"offset":3695}}}],"position":{"start":{"line":76,"column":29,"offset":3682},"end":{"line":76,"column":95,"offset":3748}}},{"type":"text","value":" in the ","position":{"start":{"line":76,"column":95,"offset":3748},"end":{"line":76,"column":103,"offset":3756}}},{"type":"html","value":"<code class=\"language-text\">global-agent</code>","position":{"start":{"line":76,"column":103,"offset":3756},"end":{"line":76,"column":117,"offset":3770}}},{"type":"text","value":" documentation.","position":{"start":{"line":76,"column":117,"offset":3770},"end":{"line":76,"column":132,"offset":3785}}}],"position":{"start":{"line":76,"column":3,"offset":3656},"end":{"line":76,"column":132,"offset":3785}}}],"position":{"start":{"line":76,"column":1,"offset":3654},"end":{"line":76,"column":132,"offset":3785}}},{"type":"paragraph","children":[{"type":"text","value":"As shown above, the ","position":{"start":{"line":78,"column":1,"offset":3787},"end":{"line":78,"column":21,"offset":3807}}},{"type":"link","title":null,"url":"https://github.com/gajus/global-agent#environment-variables","children":[{"type":"text","value":"supported environment variables","position":{"start":{"line":78,"column":22,"offset":3808},"end":{"line":78,"column":53,"offset":3839}}}],"position":{"start":{"line":78,"column":21,"offset":3807},"end":{"line":78,"column":115,"offset":3901}}},{"type":"text","value":" are all prefixed with ","position":{"start":{"line":78,"column":115,"offset":3901},"end":{"line":78,"column":138,"offset":3924}}},{"type":"html","value":"<code class=\"language-text\">GLOBAL_AGENT_</code>","position":{"start":{"line":78,"column":138,"offset":3924},"end":{"line":78,"column":153,"offset":3939}}},{"type":"text","value":" to avoid undesirable by-products](","position":{"start":{"line":78,"column":153,"offset":3939},"end":{"line":78,"column":188,"offset":3974}}},{"type":"link","title":null,"url":"https://github.com/gajus/global-agent#what-is-the-reason-global-agentbootstrap-does-not-use-http_proxy","children":[{"type":"text","value":"https://github.com/gajus/global-agent#what-is-the-reason-global-agentbootstrap-does-not-use-http_proxy","position":{"start":{"line":78,"column":188,"offset":3974},"end":{"line":78,"column":290,"offset":4076}}}],"position":{"start":{"line":78,"column":188,"offset":3974},"end":{"line":78,"column":290,"offset":4076}}},{"type":"text","value":") of using the more common non-prefixed versions (e.g. ","position":{"start":{"line":78,"column":290,"offset":4076},"end":{"line":78,"column":345,"offset":4131}}},{"type":"html","value":"<code class=\"language-text\">HTTP_PROXY</code>","position":{"start":{"line":78,"column":345,"offset":4131},"end":{"line":78,"column":357,"offset":4143}}},{"type":"text","value":").  To disable this default namespacing (i.e. prefixing), the server can be started with ","position":{"start":{"line":78,"column":357,"offset":4143},"end":{"line":78,"column":446,"offset":4232}}},{"type":"html","value":"<code class=\"language-text\">GLOBAL_AGENT_ENVIRONMENT_VARIABLE_NAMESPACE</code>","position":{"start":{"line":78,"column":446,"offset":4232},"end":{"line":78,"column":491,"offset":4277}}},{"type":"text","value":" set to an empty string:","position":{"start":{"line":78,"column":491,"offset":4277},"end":{"line":78,"column":515,"offset":4301}}}],"position":{"start":{"line":78,"column":1,"offset":3787},"end":{"line":78,"column":515,"offset":4301}}},{"type":"html","lang":"shell","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">$ <span class=\"token assign-left variable\">GLOBAL_AGENT_ENVIRONMENT_VARIABLE_NAMESPACE</span><span class=\"token operator\">=</span><span class=\"token string\">\"\"</span> <span class=\"token assign-left variable\">HTTP_PROXY</span><span class=\"token operator\">=</span>http://proxy:3128/ <span class=\"token function\">node</span> index.js</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>","position":{"start":{"line":80,"column":1,"offset":4303},"end":{"line":82,"column":4,"offset":4408}}},{"type":"paragraph","children":[{"type":"text","value":"Of course, a custom namespace can also be provided as well.  For more details on the configuration, see ","position":{"start":{"line":84,"column":1,"offset":4410},"end":{"line":84,"column":105,"offset":4514}}},{"type":"link","title":null,"url":"https://github.com/gajus/global-agent#global-agent","children":[{"type":"text","value":"the documentation for ","position":{"start":{"line":84,"column":106,"offset":4515},"end":{"line":84,"column":128,"offset":4537}}},{"type":"html","value":"<code class=\"language-text\">global-agent</code>","position":{"start":{"line":84,"column":128,"offset":4537},"end":{"line":84,"column":142,"offset":4551}}}],"position":{"start":{"line":84,"column":105,"offset":4514},"end":{"line":84,"column":195,"offset":4604}}},{"type":"text","value":".","position":{"start":{"line":84,"column":195,"offset":4604},"end":{"line":84,"column":196,"offset":4605}}}],"position":{"start":{"line":84,"column":1,"offset":4410},"end":{"line":84,"column":196,"offset":4605}}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#specifying-a-custom-ssltls-certificate","title":null,"children":[],"data":{"hProperties":{"aria-label":"specifying a custom ssltls certificate permalink","class":"anchor before"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"Specifying a custom SSL/TLS certificate","position":{"start":{"line":86,"column":4,"offset":4610},"end":{"line":86,"column":43,"offset":4649}}}],"position":{"start":{"line":86,"column":1,"offset":4607},"end":{"line":86,"column":43,"offset":4649}},"data":{"id":"specifying-a-custom-ssltls-certificate","htmlAttributes":{"id":"specifying-a-custom-ssltls-certificate"},"hProperties":{"id":"specifying-a-custom-ssltls-certificate","style":"position:relative;"}}},{"type":"paragraph","children":[{"type":"text","value":"Depending on the proxy communication, it may be necessary to extend the default \"root\" certificates which Node.js trusts to include a certificate provided by the proxy administrator.  These certificates will usually allow the proxy to handle SSL/TLS traffic and permits the proxy to analyze such traffic.","position":{"start":{"line":88,"column":1,"offset":4651},"end":{"line":88,"column":305,"offset":4955}}}],"position":{"start":{"line":88,"column":1,"offset":4651},"end":{"line":88,"column":305,"offset":4955}}},{"type":"paragraph","children":[{"type":"text","value":"This can be done ","position":{"start":{"line":90,"column":1,"offset":4957},"end":{"line":90,"column":18,"offset":4974}}},{"type":"link","title":null,"url":"https://nodejs.org/api/cli.html#cli_node_extra_ca_certs_file","children":[{"type":"text","value":"via Node.js' ","position":{"start":{"line":90,"column":19,"offset":4975},"end":{"line":90,"column":32,"offset":4988}}},{"type":"html","value":"<code class=\"language-text\">NODE_EXTRA_CA_CERTS</code>","position":{"start":{"line":90,"column":32,"offset":4988},"end":{"line":90,"column":53,"offset":5009}}},{"type":"text","value":" environment variable","position":{"start":{"line":90,"column":53,"offset":5009},"end":{"line":90,"column":74,"offset":5030}}}],"position":{"start":{"line":90,"column":18,"offset":4974},"end":{"line":90,"column":137,"offset":5093}}},{"type":"text","value":":","position":{"start":{"line":90,"column":137,"offset":5093},"end":{"line":90,"column":138,"offset":5094}}}],"position":{"start":{"line":90,"column":1,"offset":4957},"end":{"line":90,"column":138,"offset":5094}}},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The appropriate certificate (i.e. PEM file) must be present on the file-system where the server is running.","position":{"start":{"line":92,"column":4,"offset":5099},"end":{"line":92,"column":111,"offset":5206}}}],"position":{"start":{"line":92,"column":4,"offset":5099},"end":{"line":92,"column":111,"offset":5206}}}],"position":{"start":{"line":92,"column":1,"offset":5096},"end":{"line":92,"column":111,"offset":5206}}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Start the server with the ","position":{"start":{"line":93,"column":4,"offset":5210},"end":{"line":93,"column":30,"offset":5236}}},{"type":"html","value":"<code class=\"language-text\">NODE_EXTRA_CA_CERTS</code>","position":{"start":{"line":93,"column":30,"offset":5236},"end":{"line":93,"column":51,"offset":5257}}},{"type":"text","value":" environment variable set to that path, combined with the existing proxy configuration variables which were explained above:","position":{"start":{"line":93,"column":51,"offset":5257},"end":{"line":93,"column":175,"offset":5381}}}],"position":{"start":{"line":93,"column":4,"offset":5210},"end":{"line":93,"column":175,"offset":5381}}},{"type":"html","lang":"shell","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">$ <span class=\"token assign-left variable\">NODE_EXTRA_CA_CERTS</span><span class=\"token operator\">=</span>/full/path/to/certificate.pem <span class=\"token punctuation\">\\</span>\n    <span class=\"token assign-left variable\">GLOBAL_AGENT_HTTP_PROXY</span><span class=\"token operator\">=</span>http://proxy:3128/ <span class=\"token punctuation\">\\</span>\n    <span class=\"token function\">node</span> index.js</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":95,"column":4,"offset":5386},"end":{"line":99,"column":7,"offset":5531}}}],"position":{"start":{"line":93,"column":1,"offset":5207},"end":{"line":99,"column":7,"offset":5531}}}],"position":{"start":{"line":92,"column":1,"offset":5096},"end":{"line":99,"column":7,"offset":5531}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":100,"column":1,"offset":5532}}}}