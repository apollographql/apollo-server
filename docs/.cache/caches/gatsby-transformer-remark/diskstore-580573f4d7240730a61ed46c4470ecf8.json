{"expireTime":9007200901521022000,"key":"transformer-remark-markdown-html-ast-720b3a46450a6d4badfbb0423491c897-gatsby-remark-autolink-headersgatsby-remark-copy-linked-filesgatsby-remark-mermaidgatsby-remark-code-titlesgatsby-remark-prismjsgatsby-remark-rewrite-relative-linksgatsby-remark-check-links-","val":{"type":"root","children":[{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Note: Apollo Server's built-in file upload mechanism is not fully supported in Node 14 and later, and it will be removed in Apollo Server 3. For details, ","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":157,"offset":157}}},{"type":"element","tagName":"a","properties":{"href":"#uploads-in-node-14-and-later"},"children":[{"type":"text","value":"see below","position":{"start":{"line":2,"column":158,"offset":158},"end":{"line":2,"column":167,"offset":167}}}],"position":{"start":{"line":2,"column":157,"offset":157},"end":{"line":2,"column":199,"offset":199}}},{"type":"text","value":".","position":{"start":{"line":2,"column":199,"offset":199},"end":{"line":2,"column":200,"offset":200}}}],"position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":200,"offset":200}}},{"type":"text","value":"\n"}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":200,"offset":200}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"For server integrations that support file uploads (e.g. Express, hapi, Koa), Apollo Server enables file uploads by default. To enable file uploads, reference the ","position":{"start":{"line":4,"column":1,"offset":202},"end":{"line":4,"column":163,"offset":364}}},{"type":"raw","value":"<code class=\"language-text\">Upload</code>","position":{"start":{"line":4,"column":163,"offset":364},"end":{"line":4,"column":171,"offset":372}}},{"type":"text","value":" type in the schema passed to the Apollo Server construction.","position":{"start":{"line":4,"column":171,"offset":372},"end":{"line":4,"column":232,"offset":433}}}],"position":{"start":{"line":4,"column":1,"offset":202},"end":{"line":4,"column":232,"offset":433}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> ApolloServer<span class=\"token punctuation\">,</span> gql <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'apollo-server'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> typeDefs <span class=\"token operator\">=</span> gql<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n  type File {\n    filename: String!\n    mimetype: String!\n    encoding: String!\n  }\n\n  type Query {\n    uploads: [File]\n  }\n\n  type Mutation {\n    singleUpload(file: Upload!): File!\n  }\n</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> resolvers <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">Query</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function-variable function\">uploads</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">parent<span class=\"token punctuation\">,</span> args</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">Mutation</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function-variable function\">singleUpload</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">parent<span class=\"token punctuation\">,</span> args</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> args<span class=\"token punctuation\">.</span>file<span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">file</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">//Contents of Upload scalar: https://github.com/jaydenseric/graphql-upload#class-graphqlupload</span>\n        <span class=\"token comment\">//file.createReadStream() is a readable node stream that contains the contents of the uploaded file</span>\n        <span class=\"token comment\">//node stream api: https://nodejs.org/api/stream.html</span>\n        <span class=\"token keyword\">return</span> file<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> server <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ApolloServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  typeDefs<span class=\"token punctuation\">,</span>\n  resolvers<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nserver<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> url <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">ðŸš€ Server ready at </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>url<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":6,"column":1,"offset":435},"end":{"line":49,"column":4,"offset":1342}}},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Note: When using ","position":{"start":{"line":51,"column":3,"offset":1346},"end":{"line":51,"column":20,"offset":1363}}},{"type":"raw","value":"<code class=\"language-text\">typeDefs</code>","position":{"start":{"line":51,"column":20,"offset":1363},"end":{"line":51,"column":30,"offset":1373}}},{"type":"text","value":", Apollo Server adds ","position":{"start":{"line":51,"column":30,"offset":1373},"end":{"line":51,"column":51,"offset":1394}}},{"type":"raw","value":"<code class=\"language-text\">scalar Upload</code>","position":{"start":{"line":51,"column":51,"offset":1394},"end":{"line":51,"column":66,"offset":1409}}},{"type":"text","value":" to your schema, so any existing declaration of ","position":{"start":{"line":51,"column":66,"offset":1409},"end":{"line":51,"column":114,"offset":1457}}},{"type":"raw","value":"<code class=\"language-text\">scalar Upload</code>","position":{"start":{"line":51,"column":114,"offset":1457},"end":{"line":51,"column":129,"offset":1472}}},{"type":"text","value":" in the type definitions should be removed. If you create your schema with ","position":{"start":{"line":51,"column":129,"offset":1472},"end":{"line":51,"column":204,"offset":1547}}},{"type":"raw","value":"<code class=\"language-text\">makeExecutableSchema</code>","position":{"start":{"line":51,"column":204,"offset":1547},"end":{"line":51,"column":226,"offset":1569}}},{"type":"text","value":" and pass it to ","position":{"start":{"line":51,"column":226,"offset":1569},"end":{"line":51,"column":242,"offset":1585}}},{"type":"raw","value":"<code class=\"language-text\">ApolloServer</code>","position":{"start":{"line":51,"column":242,"offset":1585},"end":{"line":51,"column":256,"offset":1599}}},{"type":"text","value":" constructor using the ","position":{"start":{"line":51,"column":256,"offset":1599},"end":{"line":51,"column":279,"offset":1622}}},{"type":"raw","value":"<code class=\"language-text\">schema</code>","position":{"start":{"line":51,"column":279,"offset":1622},"end":{"line":51,"column":287,"offset":1630}}},{"type":"text","value":" param, make sure to include ","position":{"start":{"line":51,"column":287,"offset":1630},"end":{"line":51,"column":316,"offset":1659}}},{"type":"element","tagName":"a","properties":{"href":"https://www.apollographql.com/docs/guides/file-uploads.html#File-upload-with-schema-param"},"children":[{"type":"raw","value":"<code class=\"language-text\">scalar Upload</code>","position":{"start":{"line":51,"column":317,"offset":1660},"end":{"line":51,"column":332,"offset":1675}}}],"position":{"start":{"line":51,"column":316,"offset":1659},"end":{"line":51,"column":424,"offset":1767}}},{"type":"text","value":".","position":{"start":{"line":51,"column":424,"offset":1767},"end":{"line":51,"column":425,"offset":1768}}}],"position":{"start":{"line":51,"column":3,"offset":1346},"end":{"line":51,"column":425,"offset":1768}}},{"type":"text","value":"\n"}],"position":{"start":{"line":51,"column":1,"offset":1344},"end":{"line":51,"column":425,"offset":1768}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"uploads-in-node-14-and-later","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#uploads-in-node-14-and-later","aria-label":"uploads in node 14 and later permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Uploads in Node 14 and later","position":{"start":{"line":53,"column":4,"offset":1773},"end":{"line":53,"column":32,"offset":1801}}}],"position":{"start":{"line":53,"column":1,"offset":1770},"end":{"line":53,"column":32,"offset":1801}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Apollo Server's built-in support for file uploads relies on an old version of the ","position":{"start":{"line":55,"column":1,"offset":1803},"end":{"line":55,"column":83,"offset":1885}}},{"type":"element","tagName":"a","properties":{"href":"https://www.npmjs.com/package/graphql-upload"},"children":[{"type":"raw","value":"<code class=\"language-text\">graphql-upload</code>","position":{"start":{"line":55,"column":84,"offset":1886},"end":{"line":55,"column":100,"offset":1902}}},{"type":"text","value":" npm package","position":{"start":{"line":55,"column":100,"offset":1902},"end":{"line":55,"column":112,"offset":1914}}}],"position":{"start":{"line":55,"column":83,"offset":1885},"end":{"line":55,"column":159,"offset":1961}}},{"type":"text","value":" for backward compatibility. This old version is not fully compatible with Node 14.","position":{"start":{"line":55,"column":159,"offset":1961},"end":{"line":55,"column":242,"offset":2044}}}],"position":{"start":{"line":55,"column":1,"offset":1803},"end":{"line":55,"column":242,"offset":2044}}},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"To prevent similar backward compatibility issues in the future, Apollo Server 3 will not include built-in file upload support.","position":{"start":{"line":57,"column":3,"offset":2048},"end":{"line":57,"column":129,"offset":2174}}}],"position":{"start":{"line":57,"column":3,"offset":2048},"end":{"line":57,"column":129,"offset":2174}}},{"type":"text","value":"\n"}],"position":{"start":{"line":57,"column":1,"offset":2046},"end":{"line":57,"column":129,"offset":2174}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"To use file uploads with Node 14, you can disable built-in support by passing ","position":{"start":{"line":59,"column":1,"offset":2176},"end":{"line":59,"column":79,"offset":2254}}},{"type":"raw","value":"<code class=\"language-text\">uploads: false</code>","position":{"start":{"line":59,"column":79,"offset":2254},"end":{"line":59,"column":95,"offset":2270}}},{"type":"text","value":" to ","position":{"start":{"line":59,"column":95,"offset":2270},"end":{"line":59,"column":99,"offset":2274}}},{"type":"element","tagName":"a","properties":{"href":"/v2/api/apollo-server/#uploads"},"children":[{"type":"text","value":"the ","position":{"start":{"line":59,"column":100,"offset":2275},"end":{"line":59,"column":104,"offset":2279}}},{"type":"raw","value":"<code class=\"language-text\">ApolloServer</code>","position":{"start":{"line":59,"column":104,"offset":2279},"end":{"line":59,"column":118,"offset":2293}}},{"type":"text","value":" constructor","position":{"start":{"line":59,"column":118,"offset":2293},"end":{"line":59,"column":130,"offset":2305}}}],"position":{"start":{"line":59,"column":99,"offset":2274},"end":{"line":59,"column":162,"offset":2337}}},{"type":"text","value":". You can then install and use the lastest version of ","position":{"start":{"line":59,"column":162,"offset":2337},"end":{"line":59,"column":216,"offset":2391}}},{"type":"raw","value":"<code class=\"language-text\">graphql-upload</code>","position":{"start":{"line":59,"column":216,"offset":2391},"end":{"line":59,"column":232,"offset":2407}}},{"type":"text","value":" directly (","position":{"start":{"line":59,"column":232,"offset":2407},"end":{"line":59,"column":243,"offset":2418}}},{"type":"element","tagName":"a","properties":{"href":"https://www.npmjs.com/package/graphql-upload#graphql-upload"},"children":[{"type":"text","value":"see the documentation","position":{"start":{"line":59,"column":244,"offset":2419},"end":{"line":59,"column":265,"offset":2440}}}],"position":{"start":{"line":59,"column":243,"offset":2418},"end":{"line":59,"column":327,"offset":2502}}},{"type":"text","value":").","position":{"start":{"line":59,"column":327,"offset":2502},"end":{"line":59,"column":329,"offset":2504}}}],"position":{"start":{"line":59,"column":1,"offset":2176},"end":{"line":59,"column":329,"offset":2504}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":60,"column":1,"offset":2505}}}}