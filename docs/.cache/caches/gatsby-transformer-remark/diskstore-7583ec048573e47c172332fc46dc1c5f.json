{"expireTime":9007200901521021000,"key":"transformer-remark-markdown-html-ast-988a325dddd5604828e7d878f3a448c6-gatsby-remark-autolink-headersgatsby-remark-copy-linked-filesgatsby-remark-mermaidgatsby-remark-code-titlesgatsby-remark-prismjsgatsby-remark-rewrite-relative-linksgatsby-remark-check-links-","val":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Apollo Server 2.0 dramatically simplifies the API for building a GraphQL server without compromising on features. It's also completely backward compatible, so you don't have to worry about breaking changes when upgrading.","position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":222,"offset":222}}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":222,"offset":222}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"While it's possible to migrate an existing server to 2.0 without any changes, we recommend changing to new patterns we're suggesting in order to take advantage of all the latest Apollo Server features, reduce the boilerplate, and enable future flexibility.  To learn how to migrate to 2.0 from version 1.0, please read the following guide.","position":{"start":{"line":4,"column":1,"offset":224},"end":{"line":4,"column":340,"offset":563}}}],"position":{"start":{"line":4,"column":1,"offset":224},"end":{"line":4,"column":340,"offset":563}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"the-gql-tag","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#the-gql-tag","aria-label":"the gql tag permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"The ","position":{"start":{"line":6,"column":4,"offset":568},"end":{"line":6,"column":8,"offset":572}}},{"type":"raw","value":"<code class=\"language-text\">gql</code>","position":{"start":{"line":6,"column":8,"offset":572},"end":{"line":6,"column":13,"offset":577}}},{"type":"text","value":" tag","position":{"start":{"line":6,"column":13,"offset":577},"end":{"line":6,"column":17,"offset":581}}}],"position":{"start":{"line":6,"column":1,"offset":565},"end":{"line":6,"column":17,"offset":581}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Apollo Server 2.0 ships with the ","position":{"start":{"line":8,"column":1,"offset":583},"end":{"line":8,"column":34,"offset":616}}},{"type":"raw","value":"<code class=\"language-text\">gql</code>","position":{"start":{"line":8,"column":34,"offset":616},"end":{"line":8,"column":39,"offset":621}}},{"type":"text","value":" tag for ","position":{"start":{"line":8,"column":39,"offset":621},"end":{"line":8,"column":48,"offset":630}}},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"editor syntax highlighting","position":{"start":{"line":8,"column":50,"offset":632},"end":{"line":8,"column":76,"offset":658}}}],"position":{"start":{"line":8,"column":48,"offset":630},"end":{"line":8,"column":78,"offset":660}}},{"type":"text","value":" and ","position":{"start":{"line":8,"column":78,"offset":660},"end":{"line":8,"column":83,"offset":665}}},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"auto-formatting","position":{"start":{"line":8,"column":85,"offset":667},"end":{"line":8,"column":100,"offset":682}}}],"position":{"start":{"line":8,"column":83,"offset":665},"end":{"line":8,"column":102,"offset":684}}},{"type":"text","value":" with Prettier.  In the future, we will be using it for statically analyzing GraphQL queries, so Apollo Server requires wrapping your schema with ","position":{"start":{"line":8,"column":102,"offset":684},"end":{"line":8,"column":248,"offset":830}}},{"type":"raw","value":"<code class=\"language-text\">gql</code>","position":{"start":{"line":8,"column":248,"offset":830},"end":{"line":8,"column":253,"offset":835}}},{"type":"text","value":".","position":{"start":{"line":8,"column":253,"offset":835},"end":{"line":8,"column":254,"offset":836}}}],"position":{"start":{"line":8,"column":1,"offset":583},"end":{"line":8,"column":254,"offset":836}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The ","position":{"start":{"line":10,"column":1,"offset":838},"end":{"line":10,"column":5,"offset":842}}},{"type":"raw","value":"<code class=\"language-text\">gql</code>","position":{"start":{"line":10,"column":5,"offset":842},"end":{"line":10,"column":10,"offset":847}}},{"type":"text","value":" tag parses the query string into an AST  and is now exported from the new ","position":{"start":{"line":10,"column":10,"offset":847},"end":{"line":10,"column":85,"offset":922}}},{"type":"raw","value":"<code class=\"language-text\">apollo-server</code>","position":{"start":{"line":10,"column":85,"offset":922},"end":{"line":10,"column":100,"offset":937}}},{"type":"text","value":" package.","position":{"start":{"line":10,"column":100,"offset":937},"end":{"line":10,"column":109,"offset":946}}}],"position":{"start":{"line":10,"column":1,"offset":838},"end":{"line":10,"column":109,"offset":946}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> ApolloServer<span class=\"token punctuation\">,</span> gql <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'apollo-server'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> typeDefs <span class=\"token operator\">=</span> gql<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\"></span></span><span class=\"token string\">  type Query {</span>\n<span class=\"token string\">    hello: String</span>\n<span class=\"token string\">  }</span>\n<span class=\"token string\"></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//Some projects use schemas imported from external files</span>\n<span class=\"token keyword\">const</span> fs <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> typeDefs <span class=\"token operator\">=</span> gql<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>fs<span class=\"token punctuation\">.</span><span class=\"token function\">readFileSync</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/schema.graphql'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'utf8'</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//gql can also be used as regular function to convert a string to an AST</span>\n<span class=\"token keyword\">const</span> typeDefs <span class=\"token operator\">=</span> <span class=\"token function\">gql</span><span class=\"token punctuation\">(</span>fs<span class=\"token punctuation\">.</span><span class=\"token function\">readFileSync</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/schema.graphql'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'utf8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":12,"column":1,"offset":948},"end":{"line":27,"column":4,"offset":1409}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"changes-to-app-dependencies","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#changes-to-app-dependencies","aria-label":"changes to app dependencies permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Changes to app dependencies","position":{"start":{"line":29,"column":4,"offset":1414},"end":{"line":29,"column":31,"offset":1441}}}],"position":{"start":{"line":29,"column":1,"offset":1411},"end":{"line":29,"column":31,"offset":1441}}},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Apollo Server 2.0 requires Node.js v6 and higher.","position":{"start":{"line":31,"column":3,"offset":1445},"end":{"line":31,"column":52,"offset":1494}}}],"position":{"start":{"line":31,"column":3,"offset":1445},"end":{"line":31,"column":52,"offset":1494}}},{"type":"text","value":"\n"}],"position":{"start":{"line":31,"column":1,"offset":1443},"end":{"line":31,"column":52,"offset":1494}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Apollo Server 2.0 simplifies implementing a GraphQL server.  Apollo Server 1.0 revolved around providing middleware-based solutions, which had to be added to an application which already existed.  These middleware implementations were tied to the HTTP server in use (e.g. ","position":{"start":{"line":33,"column":1,"offset":1496},"end":{"line":33,"column":273,"offset":1768}}},{"type":"raw","value":"<code class=\"language-text\">apollo-server-express</code>","position":{"start":{"line":33,"column":273,"offset":1768},"end":{"line":33,"column":296,"offset":1791}}},{"type":"text","value":" for Express implementations, ","position":{"start":{"line":33,"column":296,"offset":1791},"end":{"line":33,"column":326,"offset":1821}}},{"type":"raw","value":"<code class=\"language-text\">apollo-server-hapi</code>","position":{"start":{"line":33,"column":326,"offset":1821},"end":{"line":33,"column":346,"offset":1841}}},{"type":"text","value":" for hapi, etc.).","position":{"start":{"line":33,"column":346,"offset":1841},"end":{"line":33,"column":363,"offset":1858}}}],"position":{"start":{"line":33,"column":1,"offset":1496},"end":{"line":33,"column":363,"offset":1858}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"There is a consideration to be made when following the rest of the guide:","position":{"start":{"line":35,"column":1,"offset":1860},"end":{"line":35,"column":74,"offset":1933}}}],"position":{"start":{"line":35,"column":1,"offset":1860},"end":{"line":35,"column":74,"offset":1933}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"#middleware"},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Middleware option","position":{"start":{"line":37,"column":6,"offset":1940},"end":{"line":37,"column":23,"offset":1957}}}],"position":{"start":{"line":37,"column":4,"offset":1938},"end":{"line":37,"column":25,"offset":1959}}}],"position":{"start":{"line":37,"column":3,"offset":1937},"end":{"line":37,"column":39,"offset":1973}}},{"type":"text","value":": If the application being migrated implements Apollo Server alongside other middleware, there are some packages which can be removed, but adding the ","position":{"start":{"line":37,"column":39,"offset":1973},"end":{"line":37,"column":189,"offset":2123}}},{"type":"raw","value":"<code class=\"language-text\">apollo-server-{integration}</code>","position":{"start":{"line":37,"column":189,"offset":2123},"end":{"line":37,"column":218,"offset":2152}}},{"type":"text","value":" package and switching to using the new ","position":{"start":{"line":37,"column":218,"offset":2152},"end":{"line":37,"column":258,"offset":2192}}},{"type":"raw","value":"<code class=\"language-text\">applyMiddleware</code>","position":{"start":{"line":37,"column":258,"offset":2192},"end":{"line":37,"column":275,"offset":2209}}},{"type":"text","value":" API should still simplify the setup.  In this case, check the ","position":{"start":{"line":37,"column":275,"offset":2209},"end":{"line":37,"column":338,"offset":2272}}},{"type":"element","tagName":"a","properties":{"href":"#middleware"},"children":[{"type":"text","value":"Middleware","position":{"start":{"line":37,"column":339,"offset":2273},"end":{"line":37,"column":349,"offset":2283}}}],"position":{"start":{"line":37,"column":338,"offset":2272},"end":{"line":37,"column":363,"offset":2297}}},{"type":"text","value":" section.","position":{"start":{"line":37,"column":363,"offset":2297},"end":{"line":37,"column":372,"offset":2306}}}],"position":{"start":{"line":37,"column":1,"offset":1935},"end":{"line":37,"column":372,"offset":2306}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"#stand-alone"},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Stand-alone option","position":{"start":{"line":38,"column":6,"offset":2312},"end":{"line":38,"column":24,"offset":2330}}}],"position":{"start":{"line":38,"column":4,"offset":2310},"end":{"line":38,"column":26,"offset":2332}}}],"position":{"start":{"line":38,"column":3,"offset":2309},"end":{"line":38,"column":41,"offset":2347}}},{"type":"text","value":": If the application being migrated is only used as a GraphQL server, Apollo Server 2.0 ","position":{"start":{"line":38,"column":41,"offset":2347},"end":{"line":38,"column":129,"offset":2435}}},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"eliminates the need to run a separate HTTP server","position":{"start":{"line":38,"column":130,"offset":2436},"end":{"line":38,"column":179,"offset":2485}}}],"position":{"start":{"line":38,"column":129,"offset":2435},"end":{"line":38,"column":180,"offset":2486}}},{"type":"text","value":" and allows some dependencies to be removed.  In these cases, the ","position":{"start":{"line":38,"column":180,"offset":2486},"end":{"line":38,"column":246,"offset":2552}}},{"type":"element","tagName":"a","properties":{"href":"#stand-alone"},"children":[{"type":"text","value":"Stand-alone","position":{"start":{"line":38,"column":247,"offset":2553},"end":{"line":38,"column":258,"offset":2564}}}],"position":{"start":{"line":38,"column":246,"offset":2552},"end":{"line":38,"column":273,"offset":2579}}},{"type":"text","value":" option will reduce the amount of code necessary for running a GraphQL server.","position":{"start":{"line":38,"column":273,"offset":2579},"end":{"line":38,"column":351,"offset":2657}}}],"position":{"start":{"line":38,"column":1,"offset":2307},"end":{"line":38,"column":351,"offset":2657}}},{"type":"text","value":"\n"}],"position":{"start":{"line":37,"column":1,"offset":1935},"end":{"line":38,"column":351,"offset":2657}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"simplified-usage","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#simplified-usage","aria-label":"simplified usage permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Simplified usage","position":{"start":{"line":40,"column":4,"offset":2662},"end":{"line":40,"column":20,"offset":2678}}}],"position":{"start":{"line":40,"column":1,"offset":2659},"end":{"line":40,"column":20,"offset":2678}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Check out the following changes for Apollo Server 2.0.","position":{"start":{"line":42,"column":1,"offset":2680},"end":{"line":42,"column":55,"offset":2734}}}],"position":{"start":{"line":42,"column":1,"offset":2680},"end":{"line":42,"column":55,"offset":2734}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"You no longer need to import ","position":{"start":{"line":44,"column":3,"offset":2738},"end":{"line":44,"column":32,"offset":2767}}},{"type":"raw","value":"<code class=\"language-text\">body-parser</code>","position":{"start":{"line":44,"column":32,"offset":2767},"end":{"line":44,"column":45,"offset":2780}}},{"type":"text","value":" to set up ","position":{"start":{"line":44,"column":45,"offset":2780},"end":{"line":44,"column":56,"offset":2791}}},{"type":"raw","value":"<code class=\"language-text\">apollo-server-express</code>","position":{"start":{"line":44,"column":56,"offset":2791},"end":{"line":44,"column":79,"offset":2814}}},{"type":"text","value":".","position":{"start":{"line":44,"column":79,"offset":2814},"end":{"line":44,"column":80,"offset":2815}}}],"position":{"start":{"line":44,"column":1,"offset":2736},"end":{"line":44,"column":80,"offset":2815}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"You no longer need to import ","position":{"start":{"line":45,"column":3,"offset":2818},"end":{"line":45,"column":32,"offset":2847}}},{"type":"raw","value":"<code class=\"language-text\">makeExecutableSchema</code>","position":{"start":{"line":45,"column":32,"offset":2847},"end":{"line":45,"column":54,"offset":2869}}},{"type":"text","value":" from ","position":{"start":{"line":45,"column":54,"offset":2869},"end":{"line":45,"column":60,"offset":2875}}},{"type":"raw","value":"<code class=\"language-text\">graphql-tools</code>","position":{"start":{"line":45,"column":60,"offset":2875},"end":{"line":45,"column":75,"offset":2890}}},{"type":"text","value":".","position":{"start":{"line":45,"column":75,"offset":2890},"end":{"line":45,"column":76,"offset":2891}}}],"position":{"start":{"line":45,"column":1,"offset":2816},"end":{"line":45,"column":76,"offset":2891}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"You no longer need to import ","position":{"start":{"line":46,"column":3,"offset":2894},"end":{"line":46,"column":32,"offset":2923}}},{"type":"raw","value":"<code class=\"language-text\">graphqlExpress</code>","position":{"start":{"line":46,"column":32,"offset":2923},"end":{"line":46,"column":48,"offset":2939}}},{"type":"text","value":" and ","position":{"start":{"line":46,"column":48,"offset":2939},"end":{"line":46,"column":53,"offset":2944}}},{"type":"raw","value":"<code class=\"language-text\">graphiqlExpress</code>","position":{"start":{"line":46,"column":53,"offset":2944},"end":{"line":46,"column":70,"offset":2961}}},{"type":"text","value":" from ","position":{"start":{"line":46,"column":70,"offset":2961},"end":{"line":46,"column":76,"offset":2967}}},{"type":"raw","value":"<code class=\"language-text\">apollo-server-express</code>","position":{"start":{"line":46,"column":76,"offset":2967},"end":{"line":46,"column":99,"offset":2990}}},{"type":"text","value":".","position":{"start":{"line":46,"column":99,"offset":2990},"end":{"line":46,"column":100,"offset":2991}}}],"position":{"start":{"line":46,"column":1,"offset":2892},"end":{"line":46,"column":100,"offset":2991}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"You should pass in ","position":{"start":{"line":47,"column":3,"offset":2994},"end":{"line":47,"column":22,"offset":3013}}},{"type":"raw","value":"<code class=\"language-text\">typeDefs</code>","position":{"start":{"line":47,"column":22,"offset":3013},"end":{"line":47,"column":32,"offset":3023}}},{"type":"text","value":" and ","position":{"start":{"line":47,"column":32,"offset":3023},"end":{"line":47,"column":37,"offset":3028}}},{"type":"raw","value":"<code class=\"language-text\">resolvers</code>","position":{"start":{"line":47,"column":37,"offset":3028},"end":{"line":47,"column":48,"offset":3039}}},{"type":"text","value":" as parameters to an instance of Apollo Server.","position":{"start":{"line":47,"column":48,"offset":3039},"end":{"line":47,"column":95,"offset":3086}}}],"position":{"start":{"line":47,"column":1,"offset":2992},"end":{"line":47,"column":95,"offset":3086}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"If the server is only functioning as a GraphQL server, it's no longer necessary to run your own HTTP server (like ","position":{"start":{"line":48,"column":3,"offset":3089},"end":{"line":48,"column":117,"offset":3203}}},{"type":"raw","value":"<code class=\"language-text\">express</code>","position":{"start":{"line":48,"column":117,"offset":3203},"end":{"line":48,"column":126,"offset":3212}}},{"type":"text","value":").","position":{"start":{"line":48,"column":126,"offset":3212},"end":{"line":48,"column":128,"offset":3214}}}],"position":{"start":{"line":48,"column":1,"offset":3087},"end":{"line":48,"column":128,"offset":3214}}},{"type":"text","value":"\n"}],"position":{"start":{"line":44,"column":1,"offset":2736},"end":{"line":48,"column":128,"offset":3214}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"middleware","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#middleware","aria-label":"middleware permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Middleware","position":{"start":{"line":50,"column":4,"offset":3219},"end":{"line":50,"column":14,"offset":3229}}}],"position":{"start":{"line":50,"column":1,"offset":3216},"end":{"line":50,"column":14,"offset":3229}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"With the middleware option used by Apollo Server 1.0 users, it is necessary to install the 2.0 version of ","position":{"start":{"line":52,"column":1,"offset":3231},"end":{"line":52,"column":107,"offset":3337}}},{"type":"raw","value":"<code class=\"language-text\">apollo-server-express</code>","position":{"start":{"line":52,"column":107,"offset":3337},"end":{"line":52,"column":130,"offset":3360}}},{"type":"text","value":".  To do this, install via the terminal:","position":{"start":{"line":52,"column":130,"offset":3360},"end":{"line":52,"column":170,"offset":3400}}}],"position":{"start":{"line":52,"column":1,"offset":3231},"end":{"line":52,"column":170,"offset":3400}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">npm install apollo-server-express graphql</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>","position":{"start":{"line":54,"column":1,"offset":3402},"end":{"line":54,"column":46,"offset":3447}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The changes are best shown by comparing the before and after of the application.","position":{"start":{"line":56,"column":1,"offset":3449},"end":{"line":56,"column":81,"offset":3529}}}],"position":{"start":{"line":56,"column":1,"offset":3449},"end":{"line":56,"column":81,"offset":3529}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"apollo-server-1-old-pattern","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#apollo-server-1-old-pattern","aria-label":"apollo server 1 old pattern permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Apollo Server 1 (old pattern)","position":{"start":{"line":58,"column":4,"offset":3534},"end":{"line":58,"column":33,"offset":3563}}}],"position":{"start":{"line":58,"column":1,"offset":3531},"end":{"line":58,"column":33,"offset":3563}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"An example of using Apollo Server 1 with the Express framework:","position":{"start":{"line":60,"column":1,"offset":3565},"end":{"line":60,"column":64,"offset":3628}}}],"position":{"start":{"line":60,"column":1,"offset":3565},"end":{"line":60,"column":64,"offset":3628}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> express <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'express'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> bodyParser <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'body-parser'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> makeExecutableSchema <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'graphql-tools'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> graphqlExpress <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'apollo-server-express'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> typeDefs <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n  type Query {\n    hello: String\n  }\n</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> resolvers <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">Query</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function-variable function\">hello</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token string\">'Hello world!'</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> myGraphQLSchema <span class=\"token operator\">=</span> <span class=\"token function\">makeExecutableSchema</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  typeDefs<span class=\"token punctuation\">,</span>\n  resolvers<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">PORT</span> <span class=\"token operator\">=</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// bodyParser is needed just for POST.</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/graphql'</span><span class=\"token punctuation\">,</span> bodyParser<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">graphqlExpress</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">schema</span><span class=\"token operator\">:</span> myGraphQLSchema <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PORT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":62,"column":1,"offset":3630},"end":{"line":93,"column":4,"offset":4234}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"apollo-server-2-new-pattern","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#apollo-server-2-new-pattern","aria-label":"apollo server 2 new pattern permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Apollo Server 2 (new pattern)","position":{"start":{"line":95,"column":5,"offset":4240},"end":{"line":95,"column":34,"offset":4269}}}],"position":{"start":{"line":95,"column":1,"offset":4236},"end":{"line":95,"column":34,"offset":4269}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Now, you can just do this instead:","position":{"start":{"line":97,"column":1,"offset":4271},"end":{"line":97,"column":35,"offset":4305}}}],"position":{"start":{"line":97,"column":1,"offset":4271},"end":{"line":97,"column":35,"offset":4305}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> express <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'express'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> ApolloServer<span class=\"token punctuation\">,</span> gql <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'apollo-server-express'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">PORT</span> <span class=\"token operator\">=</span> <span class=\"token number\">4000</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> typeDefs <span class=\"token operator\">=</span> gql<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n  type Query {\n    hello: String\n  }\n</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> resolvers <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">Query</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function-variable function\">hello</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token string\">'Hello world!'</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> server <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ApolloServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> typeDefs<span class=\"token punctuation\">,</span> resolvers <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nserver<span class=\"token punctuation\">.</span><span class=\"token function\">applyMiddleware</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> app <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">port</span><span class=\"token operator\">:</span> <span class=\"token constant\">PORT</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">🚀 Server ready at http://localhost:4000</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>server<span class=\"token punctuation\">.</span>graphqlPath<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":99,"column":1,"offset":4307},"end":{"line":125,"column":4,"offset":4802}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"stand-alone","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#stand-alone","aria-label":"stand alone permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Stand-alone","position":{"start":{"line":127,"column":4,"offset":4807},"end":{"line":127,"column":15,"offset":4818}}}],"position":{"start":{"line":127,"column":1,"offset":4804},"end":{"line":127,"column":15,"offset":4818}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"For starting a production-ready GraphQL server quickly, Apollo Server 2.0 ships with a built-in server, so starting a server (e.g. Express, Koa, etc.) is no longer necessary.","position":{"start":{"line":129,"column":1,"offset":4820},"end":{"line":129,"column":175,"offset":4994}}}],"position":{"start":{"line":129,"column":1,"offset":4820},"end":{"line":129,"column":175,"offset":4994}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"For these cases, it's possible to remove the existing ","position":{"start":{"line":131,"column":1,"offset":4996},"end":{"line":131,"column":55,"offset":5050}}},{"type":"raw","value":"<code class=\"language-text\">apollo-server-{integrations}</code>","position":{"start":{"line":131,"column":55,"offset":5050},"end":{"line":131,"column":85,"offset":5080}}},{"type":"text","value":" package and add the new version 2.0 of ","position":{"start":{"line":131,"column":85,"offset":5080},"end":{"line":131,"column":125,"offset":5120}}},{"type":"raw","value":"<code class=\"language-text\">apollo-server</code>","position":{"start":{"line":131,"column":125,"offset":5120},"end":{"line":131,"column":140,"offset":5135}}},{"type":"text","value":". If using Express, this can be done by running:","position":{"start":{"line":131,"column":140,"offset":5135},"end":{"line":131,"column":188,"offset":5183}}}],"position":{"start":{"line":131,"column":1,"offset":4996},"end":{"line":131,"column":188,"offset":5183}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">npm uninstall --save apollo-server-express\n\nnpm install apollo-server graphql</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":133,"column":1,"offset":5185},"end":{"line":135,"column":38,"offset":5270}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"An implementation with this pattern would look like:","position":{"start":{"line":137,"column":1,"offset":5272},"end":{"line":137,"column":53,"offset":5324}}}],"position":{"start":{"line":137,"column":1,"offset":5272},"end":{"line":137,"column":53,"offset":5324}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> ApolloServer<span class=\"token punctuation\">,</span> gql <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'apollo-server'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Construct a schema, using GraphQL schema language</span>\n<span class=\"token keyword\">const</span> typeDefs <span class=\"token operator\">=</span> gql<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n  type Query {\n    announcement: String\n  }\n</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Provide resolver functions for your schema fields</span>\n<span class=\"token keyword\">const</span> resolvers <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">Query</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function-variable function\">announcement</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n      <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Say hello to the new Apollo Server! A production ready GraphQL server with an incredible getting started experience.</span><span class=\"token template-punctuation string\">`</span></span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> server <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ApolloServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> typeDefs<span class=\"token punctuation\">,</span> resolvers <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nserver<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> url <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">🚀 Server ready at </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>url<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":139,"column":1,"offset":5326},"end":{"line":162,"column":4,"offset":5899}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"adding-additional-middleware-to-apollo-server-2","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#adding-additional-middleware-to-apollo-server-2","aria-label":"adding additional middleware to apollo server 2 permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Adding Additional Middleware to Apollo Server 2","position":{"start":{"line":164,"column":4,"offset":5904},"end":{"line":164,"column":51,"offset":5951}}}],"position":{"start":{"line":164,"column":1,"offset":5901},"end":{"line":164,"column":51,"offset":5951}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"For middleware that is collocated with the GraphQL endpoint, Apollo Server 2 allows middleware mounted on the same path before ","position":{"start":{"line":166,"column":1,"offset":5953},"end":{"line":166,"column":128,"offset":6080}}},{"type":"raw","value":"<code class=\"language-text\">applyMiddleware</code>","position":{"start":{"line":166,"column":128,"offset":6080},"end":{"line":166,"column":145,"offset":6097}}},{"type":"text","value":" is called. For example, this server runs an authentication middleware before GraphQL execution.","position":{"start":{"line":166,"column":145,"offset":6097},"end":{"line":166,"column":241,"offset":6193}}}],"position":{"start":{"line":166,"column":1,"offset":5953},"end":{"line":166,"column":241,"offset":6193}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> express <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'express'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> ApolloServer<span class=\"token punctuation\">,</span> gql <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'apollo-server-express'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> path <span class=\"token operator\">=</span> <span class=\"token string\">'/graphql'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> server <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ApolloServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> typeDefs<span class=\"token punctuation\">,</span> resolvers <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//Mount a jwt or other authentication middleware that is run before the GraphQL execution</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> jwtCheck<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nserver<span class=\"token punctuation\">.</span><span class=\"token function\">applyMiddleware</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> app<span class=\"token punctuation\">,</span> path <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">port</span><span class=\"token operator\">:</span> <span class=\"token number\">4000</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">🚀 Server ready at http://localhost:4000</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>server<span class=\"token punctuation\">.</span>graphqlPath<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":168,"column":1,"offset":6195},"end":{"line":185,"column":4,"offset":6683}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"using-an-existing-schema","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#using-an-existing-schema","aria-label":"using an existing schema permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Using an Existing Schema","position":{"start":{"line":187,"column":4,"offset":6688},"end":{"line":187,"column":28,"offset":6712}}}],"position":{"start":{"line":187,"column":1,"offset":6685},"end":{"line":187,"column":28,"offset":6712}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"For many existing instances of Apollo Server, the schema is created at runtime before server startup, using ","position":{"start":{"line":189,"column":1,"offset":6714},"end":{"line":189,"column":109,"offset":6822}}},{"type":"raw","value":"<code class=\"language-text\">makeExecutableSchema</code>","position":{"start":{"line":189,"column":109,"offset":6822},"end":{"line":189,"column":131,"offset":6844}}},{"type":"text","value":" or ","position":{"start":{"line":189,"column":131,"offset":6844},"end":{"line":189,"column":135,"offset":6848}}},{"type":"raw","value":"<code class=\"language-text\">mergeSchemas</code>","position":{"start":{"line":189,"column":135,"offset":6848},"end":{"line":189,"column":149,"offset":6862}}},{"type":"text","value":". Apollo Server 2 stays backwards compatible with these more complex schemas, accepting it as the ","position":{"start":{"line":189,"column":149,"offset":6862},"end":{"line":189,"column":247,"offset":6960}}},{"type":"raw","value":"<code class=\"language-text\">schema</code>","position":{"start":{"line":189,"column":247,"offset":6960},"end":{"line":189,"column":255,"offset":6968}}},{"type":"text","value":" field in the server constructor options. Additionally, Apollo Server 2 exports all of ","position":{"start":{"line":189,"column":255,"offset":6968},"end":{"line":189,"column":342,"offset":7055}}},{"type":"raw","value":"<code class=\"language-text\">graphql-tools</code>","position":{"start":{"line":189,"column":342,"offset":7055},"end":{"line":189,"column":357,"offset":7070}}},{"type":"text","value":", so ","position":{"start":{"line":189,"column":357,"offset":7070},"end":{"line":189,"column":362,"offset":7075}}},{"type":"raw","value":"<code class=\"language-text\">makeExecutableSchema</code>","position":{"start":{"line":189,"column":362,"offset":7075},"end":{"line":189,"column":384,"offset":7097}}},{"type":"text","value":" and other functions can be imported directly from Apollo Server.","position":{"start":{"line":189,"column":384,"offset":7097},"end":{"line":189,"column":449,"offset":7162}}}],"position":{"start":{"line":189,"column":1,"offset":6714},"end":{"line":189,"column":449,"offset":7162}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n  ApolloServer<span class=\"token punctuation\">,</span>\n  makeExecutableSchema\n<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'apollo-server'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// The `typeDefs` passed into `makeExecutableSchema` are _intentionally_</span>\n<span class=\"token comment\">// passed in without using the `gql` tag since it requires a `String` and</span>\n<span class=\"token comment\">// the `gql` tag returns an AST.  When not using `makeExecutableSchema`</span>\n<span class=\"token comment\">// and passing `typeDefs` into the `ApolloServer` constructor, it's</span>\n<span class=\"token comment\">// recommended to use the `gql` tag.</span>\n<span class=\"token keyword\">const</span> typeDefs <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n  type Query {\n    hello: String\n  }\n</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> schema <span class=\"token operator\">=</span> <span class=\"token function\">makeExecutableSchema</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  typeDefs<span class=\"token punctuation\">,</span>\n  resolvers<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//mergeSchemas can be imported from apollo-server</span>\n<span class=\"token comment\">//const schema = mergeSchemas(...);</span>\n\n<span class=\"token keyword\">const</span> server <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ApolloServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> schema <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nserver<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> url <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">🚀 Server ready at </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>url<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":191,"column":1,"offset":7164},"end":{"line":220,"column":4,"offset":7919}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"constructing-an-executable-schema-manually","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#constructing-an-executable-schema-manually","aria-label":"constructing an executable schema manually permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Constructing an Executable Schema Manually","position":{"start":{"line":222,"column":5,"offset":7925},"end":{"line":222,"column":47,"offset":7967}}}],"position":{"start":{"line":222,"column":1,"offset":7921},"end":{"line":222,"column":47,"offset":7967}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"While we recommend the use ","position":{"start":{"line":224,"column":1,"offset":7969},"end":{"line":224,"column":28,"offset":7996}}},{"type":"element","tagName":"a","properties":{"href":"https://www.apollographql.com/docs/apollo-server/schema/schema/#the-schema-definition-language"},"children":[{"type":"text","value":"schema-definition language (SDL)","position":{"start":{"line":224,"column":29,"offset":7997},"end":{"line":224,"column":61,"offset":8029}}}],"position":{"start":{"line":224,"column":28,"offset":7996},"end":{"line":224,"column":158,"offset":8126}}},{"type":"text","value":" for defining a GraphQL schema since we feel it's more human-readable and language-agnostic, Apollo Server 2 also supports schemas which are built with the ","position":{"start":{"line":224,"column":158,"offset":8126},"end":{"line":224,"column":314,"offset":8282}}},{"type":"element","tagName":"a","properties":{"href":"https://graphql.org/graphql-js/type/"},"children":[{"type":"raw","value":"<code class=\"language-text\">graphql-js</code>","position":{"start":{"line":224,"column":315,"offset":8283},"end":{"line":224,"column":327,"offset":8295}}},{"type":"text","value":"'s ","position":{"start":{"line":224,"column":327,"offset":8295},"end":{"line":224,"column":330,"offset":8298}}},{"type":"raw","value":"<code class=\"language-text\">graphql/type</code>","position":{"start":{"line":224,"column":330,"offset":8298},"end":{"line":224,"column":344,"offset":8312}}},{"type":"text","value":" notation","position":{"start":{"line":224,"column":344,"offset":8312},"end":{"line":224,"column":353,"offset":8321}}}],"position":{"start":{"line":224,"column":314,"offset":8282},"end":{"line":224,"column":392,"offset":8360}}},{"type":"text","value":" by passing a ","position":{"start":{"line":224,"column":392,"offset":8360},"end":{"line":224,"column":406,"offset":8374}}},{"type":"raw","value":"<code class=\"language-text\">GraphQLSchema</code>","position":{"start":{"line":224,"column":406,"offset":8374},"end":{"line":224,"column":421,"offset":8389}}},{"type":"text","value":" to the ","position":{"start":{"line":224,"column":421,"offset":8389},"end":{"line":224,"column":429,"offset":8397}}},{"type":"raw","value":"<code class=\"language-text\">schema</code>","position":{"start":{"line":224,"column":429,"offset":8397},"end":{"line":224,"column":437,"offset":8405}}},{"type":"text","value":" option of the ","position":{"start":{"line":224,"column":437,"offset":8405},"end":{"line":224,"column":452,"offset":8420}}},{"type":"raw","value":"<code class=\"language-text\">ApolloServer</code>","position":{"start":{"line":224,"column":452,"offset":8420},"end":{"line":224,"column":466,"offset":8434}}},{"type":"text","value":" constructor.","position":{"start":{"line":224,"column":466,"offset":8434},"end":{"line":224,"column":479,"offset":8447}}}],"position":{"start":{"line":224,"column":1,"offset":7969},"end":{"line":224,"column":479,"offset":8447}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"For example, using this technique the above schema might be represented and used as:","position":{"start":{"line":226,"column":1,"offset":8449},"end":{"line":226,"column":85,"offset":8533}}}],"position":{"start":{"line":226,"column":1,"offset":8449},"end":{"line":226,"column":85,"offset":8533}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n  graphql<span class=\"token punctuation\">,</span>\n  GraphQLSchema<span class=\"token punctuation\">,</span>\n  GraphQLObjectType<span class=\"token punctuation\">,</span>\n  GraphQLString\n<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'graphql'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> ApolloServer <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'apollo-server'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> schema <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">GraphQLSchema</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">query</span><span class=\"token operator\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">GraphQLObjectType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'RootQueryType'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">fields</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">hello</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> GraphQLString<span class=\"token punctuation\">,</span>\n        <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">return</span> <span class=\"token string\">'hello world'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> server <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ApolloServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> schema <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nserver<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> url <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">🚀 Server ready at </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>url<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":228,"column":1,"offset":8535},"end":{"line":256,"column":4,"offset":9062}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"accessing-request-headers","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#accessing-request-headers","aria-label":"accessing request headers permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Accessing Request Headers","position":{"start":{"line":258,"column":4,"offset":9067},"end":{"line":258,"column":29,"offset":9092}}}],"position":{"start":{"line":258,"column":1,"offset":9064},"end":{"line":258,"column":29,"offset":9092}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Apollo Server 1 allowed request headers to be used in the construction of the GraphQL options. Apollo Server 2 allows constructor to create the context based upon the request.","position":{"start":{"line":260,"column":1,"offset":9094},"end":{"line":260,"column":176,"offset":9269}}}],"position":{"start":{"line":260,"column":1,"offset":9094},"end":{"line":260,"column":176,"offset":9269}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">//old way</span>\n<span class=\"token function\">graphqlExpress</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">schema</span><span class=\"token operator\">:</span> myGraphQLSchema<span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">context</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">token</span><span class=\"token operator\">:</span> req<span class=\"token punctuation\">.</span>headers<span class=\"token punctuation\">[</span><span class=\"token string\">'auth-token'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">//new way</span>\n<span class=\"token keyword\">new</span> <span class=\"token class-name\">ApolloServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">schema</span><span class=\"token operator\">:</span> myGraphQLSchema<span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">context</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>req<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">token</span><span class=\"token operator\">:</span> req<span class=\"token punctuation\">.</span>headers<span class=\"token punctuation\">[</span><span class=\"token string\">'auth-token'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":262,"column":1,"offset":9271},"end":{"line":278,"column":4,"offset":9544}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"replacing-logfunction","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#replacing-logfunction","aria-label":"replacing logfunction permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Replacing ","position":{"start":{"line":280,"column":4,"offset":9549},"end":{"line":280,"column":14,"offset":9559}}},{"type":"raw","value":"<code class=\"language-text\">logFunction</code>","position":{"start":{"line":280,"column":14,"offset":9559},"end":{"line":280,"column":27,"offset":9572}}}],"position":{"start":{"line":280,"column":1,"offset":9546},"end":{"line":280,"column":27,"offset":9572}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Apollo Server 2 removes the ","position":{"start":{"line":282,"column":1,"offset":9574},"end":{"line":282,"column":29,"offset":9602}}},{"type":"raw","value":"<code class=\"language-text\">logFunction</code>","position":{"start":{"line":282,"column":29,"offset":9602},"end":{"line":282,"column":42,"offset":9615}}},{"type":"text","value":" to reduce the exposure of internal implementation details. The experimental, non-public ","position":{"start":{"line":282,"column":42,"offset":9615},"end":{"line":282,"column":131,"offset":9704}}},{"type":"raw","value":"<code class=\"language-text\">graphql-extensions</code>","position":{"start":{"line":282,"column":131,"offset":9704},"end":{"line":282,"column":151,"offset":9724}}},{"type":"text","value":" provides a more structured and flexible way of instrumenting Apollo Server. An explanation of to do more granular logging, can be found in the ","position":{"start":{"line":282,"column":151,"offset":9724},"end":{"line":282,"column":295,"offset":9868}}},{"type":"element","tagName":"a","properties":{"href":"/monitoring/metrics/"},"children":[{"type":"text","value":"metrics section","position":{"start":{"line":282,"column":296,"offset":9869},"end":{"line":282,"column":311,"offset":9884}}}],"position":{"start":{"line":282,"column":295,"offset":9868},"end":{"line":282,"column":334,"offset":9907}}},{"type":"text","value":".","position":{"start":{"line":282,"column":334,"offset":9907},"end":{"line":282,"column":335,"offset":9908}}}],"position":{"start":{"line":282,"column":1,"offset":9574},"end":{"line":282,"column":335,"offset":9908}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"replacing-graphiql","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#replacing-graphiql","aria-label":"replacing graphiql permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Replacing GraphiQL","position":{"start":{"line":284,"column":4,"offset":9913},"end":{"line":284,"column":22,"offset":9931}}}],"position":{"start":{"line":284,"column":1,"offset":9910},"end":{"line":284,"column":22,"offset":9931}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Apollo Server 2 ships with GraphQL Playground instead of GraphiQL and collocates the GUI with the endpoint. GraphQL playground can be customized in the following manner.","position":{"start":{"line":286,"column":1,"offset":9933},"end":{"line":286,"column":170,"offset":10102}}}],"position":{"start":{"line":286,"column":1,"offset":9933},"end":{"line":286,"column":170,"offset":10102}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> ApolloServer<span class=\"token punctuation\">,</span> gql <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'apollo-server-express'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> server <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ApolloServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// These will be defined for both new or existing servers</span>\n  typeDefs<span class=\"token punctuation\">,</span>\n  resolvers<span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">playground</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    endpoint<span class=\"token operator\">?</span><span class=\"token operator\">:</span> string\n    subscriptionEndpoint<span class=\"token operator\">?</span><span class=\"token operator\">:</span> string\n    <span class=\"token literal-property property\">tabs</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">endpoint</span><span class=\"token operator\">:</span> string\n        <span class=\"token literal-property property\">query</span><span class=\"token operator\">:</span> string\n        variables<span class=\"token operator\">?</span><span class=\"token operator\">:</span> string\n        responses<span class=\"token operator\">?</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n        headers<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">[</span>key<span class=\"token operator\">:</span> string<span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> string <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nserver<span class=\"token punctuation\">.</span><span class=\"token function\">applyMiddleware</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  app<span class=\"token punctuation\">,</span> <span class=\"token comment\">// app is from an existing express app</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">port</span><span class=\"token operator\">:</span> <span class=\"token number\">4000</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">🚀 Server ready at http://localhost:4000</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>server<span class=\"token punctuation\">.</span>graphqlPath<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","position":{"start":{"line":288,"column":1,"offset":10104},"end":{"line":317,"column":4,"offset":10752}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Some Apollo Server 1 implementations use a custom version of GraphiQL, which can be added to Apollo Server 2 as a middleware or ported to use the ","position":{"start":{"line":319,"column":1,"offset":10754},"end":{"line":319,"column":147,"offset":10900}}},{"type":"element","tagName":"a","properties":{"href":"https://www.npmjs.com/package/graphql-playground-react"},"children":[{"type":"text","value":"React version of GraphQL Playground","position":{"start":{"line":319,"column":148,"offset":10901},"end":{"line":319,"column":183,"offset":10936}}}],"position":{"start":{"line":319,"column":147,"offset":10900},"end":{"line":319,"column":240,"offset":10993}}},{"type":"text","value":".","position":{"start":{"line":319,"column":240,"offset":10993},"end":{"line":319,"column":241,"offset":10994}}}],"position":{"start":{"line":319,"column":1,"offset":10754},"end":{"line":319,"column":241,"offset":10994}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":320,"column":1,"offset":10995}}}}