---
title: Generating types from a GraphQL Schema
description: How to ensure your resolvers type safe
---

> ðŸ‘‹ If you haven't set up a TypeScript project yet, follow our [Getting Started](../../getting-started) guide to set one up quickly. 

GraphQL uses a type system to clearly define the available data for each type and field in a [GraphQL schema](../schema/schema). Type generation libraries can take advantage of the strongly-typed nature of a GraphQL schema to generate TypeScript types. 

You can use these generated TS types in your resolvers to type-check that your resolver's return values match the field types dictated by your schema. Type checking your resolvers enables you to quickly catch errors, and give you the peace of mind that type safety ensures. 

> Looking to generate types for your [Apollo Federation](/federation/) subgraphs? Our [Subgraph Template](https://github.com/apollographql/subgraph-template-typescript-apollo-server) lays down the ground work so you can quickly set up a subgraph with generated types.

## Setting up your project

This article describes how to use the [GraphQL Code Generator](https://www.the-guild.dev/graphql/codegen) library to generate types based on a GraphQL schema. Note, there are multiple ways to provide a schema to GraphQL Code Generator, but this guide covers how to generate types based off of a `.graphql` file.

If you haven't already, move your server's schema into a `.graphql` file, like so:

```graphql title="schema.graphql"
type Query {
  books: [Book]
}

type Book {
  title: String
  author: String
}

type AddBookMutationResponse {
  code: String!
  success: Boolean!
  message: String!
  book: Book
}

type Mutation {
  addBook(title: String, author: String): AddBookMutationResponse
}
```

Next, you'll need to update your imports to ensure you're still passing your schema to your server. In the file where you create your server, you can update your imports to read in your schema using `readFileSync` from the `fs` package:

```ts title="index.ts"
// ...other imports
import { readFileSync } from 'fs';
import path, { dirname } from 'path';
import { fileURLToPath } from 'url';

// If you are using ESM module syntax you can redefine `__dirname` as 
// shown below. If you are using CJS syntax you can use `__dirname` directly.
const __dirname = dirname(fileURLToPath(import.meta.url));
const schemaFile = path.join(__dirname, '../schema.graphql');
// Once we have the file path, read in our schema 
const typeDefs = readFileSync(schemaFile, { encoding: 'utf-8' });

const server = new ApolloServer<MyContext>({
  typeDefs,
  resolvers,
});

// ... start our server
```

Restart your server to make sure it can find and use your schema, and that everything works as expected.

Next, we'll install the packages we need to automatically generate types based on our schema. 

### Installing dependencies

Install the follow packages as dev dependencies:

```bash
npm install -D @graphql-codegen/cli @graphql-codegen/typescript @graphql-codegen/typescript-resolvers
```

> For more information on each of the packages above, check out the [GraphQL Code Generator](https://www.the-guild.dev/graphql/codegen/plugins) docs.

Next, we'll set up a configuration file telling GraphQL Code Generator where and how to generate types. You can do this by manually creating a `codegen.yml` file, or by using the following command:

```bash
npx graphql-code-generator init
```

Below is an example of a `codegen.yml` file we created:

```yaml
# This configuration file tells GraphQL Code Generator how
# to generate types based on our schema.
schema: "./schema.graphql"
generates:
  # Specify where our generated types should live.
  ./src/__generated__/resolvers-types.ts:
    plugins:
      - "typescript"
      - "typescript-resolvers"
    config:
      useIndexSignature: true
```

> [See the docs](https://www.the-guild.dev/graphql/codegen/plugins/typescript-resolvers#usage-example) for more information on the above configuration options.

Next, we'll add some helpful scripts to our `package.json` file to ensure our types are generated regularly:

```json
{
// ...
  "scripts": {
    "generate": "graphql-codegen --config codegen.yml",
    "postinstall": "tsc && npm run generate",
    "build": "tsc --build && npm run generate",
    "start": "npm run build && node ./dist/index.js",
  },
// ...
}
```

Running the `npm start` command now compiles your TypeScript code and automatically generates types based off of your GraphQL schema. You should see a new file full of generated types at the path you specified in your `codegen.yml`. 

## Adding types to resolvers

The `typescript-resolvers` plugin creates a `Resolvers` type that you can use to add a type to your resolvers map, ensuring your resolvers return the same fields and types specified by your schema. 

Import the `Resolvers` type from the file with your generated types:

```ts
// This is the file path we specified in our `codegen.yml`
import { Resolvers } from './__generated__/resolvers-types';
```

You can now add the `Resolvers` type directly to your resolver map:

```ts
const resolvers: Resolvers = {}
```

Your resolvers can now type check that the data returned by each resolver matches the schema:

```ts
const resolvers: Resolvers = {
  Query: {
    // TypeScript will now complain about the below resolver because
    // the data returned by this resolver doesn't match the schema type
    // (i.e., type Query { books: [Book] })
    books: () => {
      return "apple";
    },
  },
}
```

### Configuring context typing for resolvers

You can configure GraphQL Code Generator to add types for your context to all of your resolvers, ensuring you don't try to access a value on your context that isn't there.

First, export the interface you pass to Apollo Server to type your `context` function:

```ts title="index.ts"
// highlight-start
export interface MyContext {
  dataSources: {
    books: Book[];
  };
}
// highlight-end

const server = new ApolloServer<MyContext>({
  typeDefs,
  resolvers,
});
```

Next, add a `contextType` configuration option to your `codegen.yml`:

```yaml
# This configuration file tells GraphQL Code Generator how to generate types based on our schema.
schema: "./schema.graphql"
generates:
  ./src/__generated__/resolvers-types.ts:
    plugins:
      - "typescript"
      - "typescript-resolvers"
    config:
      useIndexSignature: true
      # Providing our context's interface ensures our context's type is set for
      # all of our resolvers. 

      # This file path starts from location of the file where you generate
      # types (i.e., `/src/__generated__/resolvers-types.ts` above) 
      contextType: ../index#MyContext
```

After you regenerate your types (i.e., `npm start`) your context is now automatically typed in all of your resolvers:

```ts
const resolvers: Resolvers = {
  Query: {
    // Our third argument (`contextValue`) has a type here, so we
    // can check the properties within our resolver's shared context value.
    books: (_, __, contextValue) => {
      return contextValue.dataSources.books;
    },
  },
}
```


## Basic runnable example

Check out our example with generated types on CodeSandbox:

<a href="https://codesandbox.io/s/github/apollographql/docs-examples/tree/main/apollo-server/v4/generated-types?fontsize=14&hidenavigation=1&initialpath=%2Fgraphql&theme=dark">
  <img
    alt="Edit server-generated-types-as4"
    src="https://codesandbox.io/static/img/play-codesandbox.svg"
  />
</a>

